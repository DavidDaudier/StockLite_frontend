<!-- Mobile Backdrop -->
<div 
  *ngIf="mobileOpen()" 
  (click)="closeMobileSidebar()"
  class="fixed inset-0 bg-black/50 z-40 md:hidden transition-opacity"
  aria-hidden="true">
</div>

<!-- Sidebar Container -->
<aside 
  [ngClass]="{
    'translate-x-0': mobileOpen(),
    '-translate-x-full': !mobileOpen(),
    'w-20': collapsed() && !mobileOpen(),
    'w-64': !collapsed() || mobileOpen()
  }"
  class="fixed md:static inset-y-0 left-0 z-50 bg-white border-r border-gray-200 flex flex-col h-screen transition-all duration-300 md:translate-x-0">
  
  <!-- Logo/Brand -->
  <div class="p-4 border-b border-gray-200 flex justify-between items-center">
    <div class="flex items-center gap-3">
      <div class="w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 overflow-hidden"
           [ngStyle]="{'background-color': appInfoService.appInfo().logo_bg_color || '#0d9488'}">
        <img *ngIf="appInfoService.appInfo().logo_app" [src]="appInfoService.appInfo().logo_app" alt="Logo" class="w-full h-full object-cover">
        <svg *ngIf="!appInfoService.appInfo().logo_app" class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
        </svg>
      </div>
      <div *ngIf="!collapsed() || mobileOpen()" class="overflow-hidden">
        <h1 class="font-bold text-lg" [ngStyle]="{'color': appInfoService.appInfo().color_nom_app || '#000000'}">{{ appInfoService.appInfo().nom_app }}</h1>
        <p class="text-xs" [ngStyle]="{'color': appInfoService.appInfo().color_sous_titre_app || '#6B7280'}">{{ appInfoService.appInfo().sous_titre_app || 'POS System' }}</p>
      </div>
    </div>
    
    <!-- Close button for mobile -->
    <button 
      *ngIf="mobileOpen()" 
      (click)="closeMobileSidebar()"
      class="md:hidden p-2 rounded-lg hover:bg-gray-100 text-gray-500">
      <ng-icon name="hugeArrowLeft01" class="text-xl" />
    </button>
  </div>

  <!-- Menu Items -->
  <nav class="flex-1 overflow-y-auto p-4 space-y-2 sidebar-nav">
    <a
      *ngFor="let item of menuItems"
      [routerLink]="item.route"
      routerLinkActive="bg-teal-100 text-teal-600 border-teal-500 border-l-4 border-l-teal-500 font-bold"
      [routerLinkActiveOptions]="{exact: true}"
      [ngClass]="(collapsed() && !mobileOpen()) ? 'justify-center px-2' : 'px-4'"
      [title]="(collapsed() && !mobileOpen()) ? item.label : ''"
      class="flex items-center gap-3 py-3 rounded-r-lg transition-colors hover:bg-gray-100 border border-transparent group">
      <ng-icon [name]="item.icon"  class="text-xl flex-shrink-0 font-bold" />
      <span *ngIf="!collapsed() || mobileOpen()" class="font-medium overflow-hidden">{{ item.label }}</span>
    </a>
  </nav>

  <!-- Bottom Actions -->
  <div class="p-4 border-t border-gray-200 space-y-2">
    <button
      (click)="logout()"
      [ngClass]="(collapsed() && !mobileOpen()) ? 'justify-center px-2' : 'px-4'"
      [title]="(collapsed() && !mobileOpen()) ? 'Déconnexion' : ''"
      class="flex items-center gap-3 w-full py-3 rounded-lg transition-colors hover:bg-red-50 hover:text-red-600 text-gray-700">
      <ng-icon name="hugeLogout03" class="text-xl flex-shrink-0" />
      <span *ngIf="!collapsed() || mobileOpen()" class="font-medium">Déconnexion</span>
    </button>
  </div>
</aside>
